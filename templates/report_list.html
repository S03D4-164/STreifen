{% extends "base.html" %}

{% block title %}
<title>Report</title>
{% endblock %}

{% block jquery %}
<script>
$(document).ready(
        function(){
                $('a[data-toggle="tab"]').on( 'shown.bs.tab', function (e) {
                    $.fn.dataTable.tables( {visible: true, api: true} ).columns.adjust();
                } );
		$('#report_table').dataTable({
                    "processing":true,
                    "serverSide":true,
                    "ajax": "{% url 'report_data' %}",
                    "order":[0, 'desc'],
                });
                //$('#id_firstseen').datetimepicker({
                //        format:'Y-m-d H:i'
                //});
                $('tbody').on('click', '.btn', function (e) {
                        table_btn($(this));
                });
	}
);
</script>
{% endblock%}

{% block container %}

<div class="modal" id="report_form" role="dialog">
<div class="modal-dialog">
<div class="modal-content">

<div class="modal-header">
<button type="button" class="close" data-dismiss="modal">&times;</button>
<h4 class="modal-title">Create Report</h4>
</div>

<div class="modal-body">
<form method=post>{% csrf_token %}

<div><p>Name:</p>
{{form.name}}
</div>
<hr>
<div class="col-md-12">

<div class="col-md-5">
<p>Labels:</p>
{{form.labels}}
</div>

<div class="col-md-7">
<p>Description:</p>
{{form.description}}
</div>

</div>

<input class="btn btn-primary btn-sm" type="submit" name="create" value="create">
</form>
</div><!--/.modal-body-->

</div><!--/.modal-content-->
</div><!--/.modal-dialog-->
</div><!--/.modal-->

<div class="col-md-12">
<h3 style="margin-top: 0">Report
<a class="btn btn-primary btn-sm" data-toggle="modal" href="#report_form">Create</a>
</h3>
<hr>
</div>


<div id="list" class="col-md-6">

<ul class="nav nav-pills">
<!--
  <li class="active" ><a data-toggle="tab" href="#report">Report({{recordsTotal|length}})</a></li>
-->
</ul>

<div class="tab-content">

<div class="tab-pane active" id="report" >
<table id="report_table" class="table table-condensed table-stripe table-hover display" width="100%">
<thead><tr>
<th class="col-sm-2">ID</th>
<th >Created</th>
<th >Name</th>
</tr></thead>
</table>
</div><!--/#report-->

</div><!--/tab-content-->

</div><!--col-md-6-->

<div class="col-md-6">
<div class="panel panel-primary">

<div class="panel-heading">
</div>

<div class="panel-body">
<table id="selected_report" class="table table-condensed">
<tr><th class="col-md-3">Object ID</th><td><a href="/report/{{report.id}}">{{report.object_id}}</a></td></tr>
<tr><th>Name</th><td>{{report.name}}</td></tr>
<tr><th>Created</th><td>{{report.created}}</td></tr>
<tr><th>Modified</th><td>{{report.modified}}</td></tr>
<tr><th>Labels</th>
<td>
{% for l in report.labels.all %}
{{l}}<br>
{% endfor %}
</td></tr>
</table>
<table class="table table-condensed">
<tr><th>Description</th></tr>
<tr><td><pre>{{report.description}}</pre></td></tr>
</table>
</div><!--/.panel-body-->
</div><!--/.panel-->
</div><!--/.col-md-6-->

{% endblock %}
